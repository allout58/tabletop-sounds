language: node_js
node_js:
  - 10

cache:
  directories:
    - ~/.npm

before_install:
  - mv ci.npmrc .npmrc

before_script:
  - yarn ng version
  - if [ "${TRAVIS_PULL_REQUEST_BRANCH}" == ""]; then EXPORT CI_COMMIT_BEFORE_SHA="HEAD~1"; else EXPORT CI_COMMIT_BEFOR_SHA="${TRAVIS_PULL_REQUEST_BRANCH}";fi;

script:
  - yarn ci:commitlint
  - yarn ci:lint
  - yarn ci:test
  - yarn ci:build

after_success:
  - npm run travis-deploy-once "npm run semantic-release"

branches:
  except:
    - /^v\d+\.\d+\.\d+$/
